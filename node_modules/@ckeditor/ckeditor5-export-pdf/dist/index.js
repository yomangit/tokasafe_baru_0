/*
 *             Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
import{Command as _0x4ec3b2,Plugin as _0x26c382}from'@ckeditor/ckeditor5-core/dist/index.js';import{ButtonView as _0x5510b8,MenuBarMenuListItemButtonView as _0x3da89f,SpinnerView as _0x7eaf7b,Notification as _0x2d6a25}from'@ckeditor/ckeditor5-ui/dist/index.js';function a(){const _0x7d3823=[],_0x4e1939=[];for(const _0x24879d of Array['from'](document['styleSheets'])){if(_0x24879d['ownerNode']['hasAttribute']('data-cke')){for(const _0x5b9891 of Array['from'](_0x24879d['cssRules']))-0x1!==_0x5b9891['cssText']['indexOf']('.ck-content')?_0x7d3823['push'](_0x5b9891['cssText']):-0x1!==_0x5b9891['cssText']['indexOf'](':root')&&_0x4e1939['push'](_0x5b9891['cssText']);}}return _0x7d3823['length']||console['warn']('The\x20editor\x20stylesheet\x20could\x20not\x20be\x20found\x20in\x20the\x20document.\x20Check\x20your\x20webpack\x20config\x20â€“\x20style-loader\x20should\x20use\x20data-cke=true\x20attribute\x20for\x20the\x20editor\x20stylesheet.'),[..._0x4e1939,..._0x7d3823]['join']('\x20')['trim']();}function d(_0x6dd79c,_0x68bc8a){const t=_0x6dd79c['t'];switch(_0x68bc8a){case'Export\x20to\x20PDF':return t('Export\x20to\x20PDF');case'An\x20error\x20occurred\x20while\x20generating\x20the\x20PDF.':return t('An\x20error\x20occurred\x20while\x20generating\x20the\x20PDF.');case'PDF\x20export\x20started':return t('PDF\x20export\x20started');case'PDF\x20export\x20failed':return t('PDF\x20export\x20failed');case'PDF\x20export\x20successful':return t('PDF\x20export\x20successful');case'Exporting\x20PDF\x20document':return t('Exporting\x20PDF\x20document');default:return _0x68bc8a;}}class e extends _0x4ec3b2{constructor(_0x1c2725){super(_0x1c2725),this['set']('isBusy',!0x1),this['affectsData']=!0x1;}['refresh'](){this['isEnabled']=!this['isBusy'],this['value']=this['isBusy']?'pending':void 0x0;}['execute'](_0x10698a={}){const _0x6c44a7=this['editor'],_0x2578eb=_0x10698a['converterUrl']||'https://pdf-converter.cke-cs.com/v1/convert/',_0x21791c=_0x10698a['dataCallback']||(_0x1d5669=>_0x1d5669['data']['get']()),_0x17df45=_0x6c44a7['plugins']['get']('ExportPdf'),_0x196d4c=_0x10698a['token']||_0x17df45['_token'];return this['isBusy']=!0x0,this['refresh'](),function(_0x395976){if(!_0x395976)return new Promise(_0x497787=>_0x497787(''));const _0x4246b5=[];for(const _0x5a3ad4 of _0x395976)'EDITOR_STYLES'!==_0x5a3ad4?_0x4246b5['push'](window['fetch'](_0x5a3ad4)['then'](_0x3a42cd=>_0x3a42cd['text']())):_0x4246b5['push'](a());return Promise['all'](_0x4246b5)['then'](_0x3f75dc=>_0x3f75dc['join']('\x20')['trim']());}(_0x10698a['stylesheets']||['EDITOR_STYLES'])['then'](async _0x9d67f=>{if(_0x6c44a7['ui']['ariaLiveAnnouncer']['announce'](d(_0x6c44a7['locale'],'PDF\x20export\x20started')),_0x6c44a7['plugins']['has']('MergeFields')){_0x10698a['converterOptions']||(_0x10698a['converterOptions']={});const _0x24cfae=_0x6c44a7['plugins']['get']('MergeFieldsEditing'),_0x555fef=_0x24cfae['previewMode'],{prefix:_0x32dd59,suffix:_0x268c5e}=_0x6c44a7['config']['get']('mergeFields'),_0x596f99={'prefix':_0x32dd59,'suffix':_0x268c5e,'data':{}};if('$labels'===_0x555fef){for(const _0x3a48e0 of _0x24cfae['getMergeFieldsIds']())_0x596f99['data'][_0x3a48e0]=_0x32dd59+_0x24cfae['getLabel'](_0x3a48e0)+_0x268c5e;}else{const _0x5600a7='$defaultValues'===_0x555fef?_0x24cfae['getDefaultValues']():_0x24cfae['getDataSetValues'](_0x555fef,!0x0);for(const _0x1f919c of Object['entries'](_0x5600a7)){const [_0x559b53,_0x20fe8f]=_0x1f919c;_0x596f99['data'][_0x559b53]=null!==_0x20fe8f?_0x20fe8f:_0x24cfae['getLabel'](_0x559b53);}}_0x10698a['converterOptions']['merge_fields']=_0x596f99;}const _0x32394c={'html':'<html>\x0a\x09\x09\x09\x09\x09\x09<head>\x0a\x09\x09\x09\x09\x09\x09\x09<title>CKEditor\x205\x20PDF\x20document</title>\x0a\x09\x09\x09\x09\x09\x09\x09<meta\x20charset=\x22utf-8\x22>\x0a\x09\x09\x09\x09\x09\x09</head>\x0a\x09\x09\x09\x09\x09\x09<body>\x0a\x09\x09\x09\x09\x09\x09\x09<div\x20class=\x22ck-content\x22\x20dir=\x22'+_0x6c44a7['locale']['contentLanguageDirection']+'\x22>\x0a\x09\x09\x09\x09\x09\x09\x09\x09'+await _0x21791c(_0x6c44a7)+'\x0a\x09\x09\x09\x09\x09\x09\x09</div>\x0a\x09\x09\x09\x09\x09\x09</body>\x0a\x09\x09\x09\x09\x09</html>','css':_0x9d67f,'options':_0x10698a['converterOptions']},_0x429caa={'method':'POST','headers':{'Content-Type':'application/json','Accept':'application/pdf',..._0x196d4c?{'Authorization':_0x196d4c['value']}:null,'x-cs-app-id':_0x10698a['appID']||'cke5'},'body':JSON['stringify'](_0x32394c)};return window['fetch'](_0x2578eb,_0x429caa)['then'](_0x48d61a=>{if(0xc8!==_0x48d61a['status'])throw _0x48d61a;return _0x48d61a['blob']();})['then'](_0x41cdc1=>{_0x6c44a7['ui']['ariaLiveAnnouncer']['announce'](d(_0x6c44a7['locale'],'PDF\x20export\x20successful'));const _0x27274f='function'==typeof _0x10698a['fileName']?_0x10698a['fileName']():_0x10698a['fileName'];this['_downloadFile'](_0x41cdc1,_0x27274f||'document.pdf');});})['catch'](_0x34254e=>{const _0x28403=_0x6c44a7['plugins']['get']('Notification');throw _0x6c44a7['ui']['ariaLiveAnnouncer']['announce'](d(_0x6c44a7['locale'],'PDF\x20export\x20failed'),{'politeness':'assertive'}),_0x28403['showWarning'](d(_0x6c44a7['locale'],'An\x20error\x20occurred\x20while\x20generating\x20the\x20PDF.')),_0x34254e;})['finally'](()=>{this['isBusy']=!0x1,this['refresh']();});}['_downloadFile'](_0x5c6406,_0x5ac5b4){const _0x1ab4c8=document['createElement']('a');_0x1ab4c8['href']=window['URL']['createObjectURL'](_0x5c6406),_0x1ab4c8['download']=_0x5ac5b4,_0x1ab4c8['click'](),_0x1ab4c8['remove']();}}class s extends _0x26c382{static get['pluginName'](){return'ExportPdfUI';}static get['isOfficialPlugin'](){return!0x0;}static get['isPremiumPlugin'](){return!0x0;}['init'](){const _0x550cf6=this['editor'];_0x550cf6['ui']['componentFactory']['add']('exportPdf',()=>{const _0x294447=this['_createButton'](_0x5510b8),_0x513283=_0x550cf6['commands']['get']('exportPdf');return _0x294447['set']({'tooltip':!0x0}),_0x294447['bind']('isOn')['to'](_0x513283,'isBusy'),_0x294447;}),_0x550cf6['ui']['componentFactory']['add']('menuBar:exportPdf',()=>this['_createButton'](_0x3da89f));}['_createButton'](_0x42f1c2){const _0x93bd92=this['editor'],_0x309aa7=_0x93bd92['config']['get']('exportPdf')||{},_0x34dae4=_0x93bd92['commands']['get']('exportPdf'),_0x2e8250=new _0x42f1c2(_0x93bd92['locale']),_0x394f47=new _0x7eaf7b();return _0x2e8250['children']['add'](_0x394f47),_0x394f47['bind']('isVisible')['to'](_0x34dae4,'isBusy'),_0x2e8250['iconView']['bind']('isVisible')['to'](_0x34dae4,'isBusy',_0x2df036=>!_0x2df036),_0x2e8250['set']({'icon':'<svg\x20viewBox=\x220\x200\x2020\x2020\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22><path\x20d=\x22M19\x204.5\x2014\x200H3v6.5h1.5v-5h8v5h5V11H19V4.5ZM14\x202l3.3\x203H14V2Z\x22/><path\x20d=\x22m12.452\x2018.5\x201.25\x201.5H3v-3h1.5v1.5h7.952Z\x22/><path\x20d=\x22M19.826\x2016.843a.75.75\x200\x201\x200-1.152-.96L17.5\x2017.29V13H16v4.29l-1.174-1.408a.75.75\x200\x201\x200-1.152.96l2.346\x202.816a.95.95\x200\x200\x200\x201.46\x200l2.346-2.815Z\x22/><path\x20d=\x22M1.63\x2014.24V12.3h.88c.66\x200\x201.14-.15\x201.46-.45.32-.3.48-.71.48-1.24\x200-.52-.15-.91-.44-1.2C3.7\x209.15\x203.28\x209\x202.69\x209H0v5.24h1.63Zm.4-3h-.4v-1.17h.46c.3\x200\x20.5.05.62.17.1.11.16.25.16.42\x200\x20.16-.06.3-.19.41-.13.11-.34.16-.66.16l.01.01Zm5.7\x203c.28\x200\x20.6-.05.96-.14.26-.07.5-.21.73-.42.22-.2.4-.47.53-.77.12-.31.19-.75.19-1.3\x200-.37-.04-.7-.13-1.02a2.3\x202.3\x200\x200\x200-.42-.84c-.19-.24-.43-.43-.72-.56C8.57\x209.06\x208.2\x209\x207.72\x209h-2.4v5.24H7.73Zm-.4-1.19h-.4v-2.86h.4c.43\x200\x20.73.1.91.3.18.2.27.59.27\x201.14\x200\x20.42-.04.73-.12.91a.76.76\x200\x200\x201-.34.4c-.14.07-.38.11-.72.11Zm5.3\x201.2V12.1h2.02v-1.06h-2.03v-.91H15V9h-4v5.24h1.62l.01.01Z\x22/></svg>\x0a'}),_0x2e8250['bind']('isEnabled')['to'](_0x34dae4,'isEnabled'),_0x2e8250['bind']('label')['to'](_0x34dae4,'isBusy',_0x1d8dcd=>d(_0x93bd92['locale'],_0x1d8dcd?'Exporting\x20PDF\x20document':'Export\x20to\x20PDF')),this['listenTo'](_0x2e8250,'execute',()=>{_0x93bd92['execute']('exportPdf',_0x309aa7),_0x93bd92['editing']['view']['focus']();}),_0x2e8250;}}class o extends _0x26c382{['_token'];static get['pluginName'](){return'ExportPdf';}static get['isOfficialPlugin'](){return!0x0;}static get['isPremiumPlugin'](){return!0x0;}static get['requires'](){return['CloudServices',_0x2d6a25,s];}['init'](){const _0x3bfb02=this['editor'],_0x55c611=_0x3bfb02['config']['get']('exportPdf')||{};_0x3bfb02['commands']['add']('exportPdf',new e(_0x3bfb02));const _0x261f48=_0x3bfb02['plugins']['get']('CloudServices');!0x1===_0x55c611['tokenUrl']?this['_token']=null:_0x55c611['tokenUrl']?_0x261f48['registerTokenUrl'](_0x55c611['tokenUrl'])['then'](_0x15f312=>{this['_token']=_0x15f312;}):this['_token']=_0x261f48['token'];}}export{o as ExportPdf};