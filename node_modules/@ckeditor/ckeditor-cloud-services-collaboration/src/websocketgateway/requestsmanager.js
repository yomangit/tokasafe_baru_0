/*
 *             Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
import _0x3bd13c from'../ckeditorcloudserviceserror.js';class WebSocketRequest{constructor(_0x27ed28,_0x3d1961){this['_context']=_0x27ed28,this['_deferredPromise']=(function(){let _0x1aa40a,_0x99fe8d;const _0x1e6088=new Promise((_0x29906d,_0x4cb774)=>{_0x1aa40a=_0x29906d,_0x99fe8d=_0x4cb774;});return{'resolve':_0x1aa40a,'reject':_0x99fe8d,'promise':_0x1e6088};}()),this['timeout']=setTimeout(()=>this['error'](new _0x3bd13c('Request\x20timeout.',this['_context'])),_0x3d1961);}get['promise'](){return this['_deferredPromise']['promise'];}['response'](_0x4b8320){this['_deferredPromise']['resolve'](_0x4b8320);}['error'](_0x51d151){this['_deferredPromise']['reject'](_0x51d151);}}export default class WebSocketGatewayRequestsManager{constructor(_0x5dcfa3){this['_context']=_0x5dcfa3,this['_requests']=new Set();}async['send'](_0x21f0dd,_0x54f120=0xafc8){const _0x168238=this['_createRequest'](_0x54f120);try{return _0x21f0dd(_0x168238),await _0x168238['promise'];}finally{this['_finishRequest'](_0x168238);}}['errorAll'](_0xbfb962){for(const _0x29d957 of this['_requests'])_0x29d957['error'](_0xbfb962);}['waitForAllRequests'](_0x1ff873=0xafc8){return this['_waitForRequests'](_0x1ff873);}['_createRequest'](_0xff5038){const _0x2d213e=new WebSocketRequest(this['_context'],_0xff5038);return this['_requests']['add'](_0x2d213e),_0x2d213e;}['_finishRequest'](_0x46349b){this['_requests']['delete'](_0x46349b),clearTimeout(_0x46349b['timeout']);}async['_waitForRequests'](_0x2e29e7=0x1388,_0x26565f=0x0){return!this['_requests']['size']||_0x26565f>=_0x2e29e7/0x1f4?Promise['resolve']():(await new Promise(_0x102410=>{setTimeout(_0x102410,0x1f4);}),this['_waitForRequests'](_0x2e29e7,_0x26565f++));}}