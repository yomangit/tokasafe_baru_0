/*
 *             Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
import{Command as _0x522483,Plugin as _0x3ca72f}from'@ckeditor/ckeditor5-core/dist/index.js';import{ButtonView as _0x367d58,MenuBarMenuListItemButtonView as _0x30fe83,SpinnerView as _0x9b1174,Notification as _0x1083aa}from'@ckeditor/ckeditor5-ui/dist/index.js';import{logWarning as _0x49ef73}from'@ckeditor/ckeditor5-utils/dist/index.js';function f(){const _0x115eef=[],_0x2dee3a=[];for(const _0x3ef42c of Array['from'](document['styleSheets'])){if(_0x3ef42c['ownerNode']['hasAttribute']('data-cke')){for(const _0x3aa3c8 of Array['from'](_0x3ef42c['cssRules']))-0x1!==_0x3aa3c8['cssText']['indexOf']('.ck-content')?_0x115eef['push'](_0x3aa3c8['cssText']):-0x1!==_0x3aa3c8['cssText']['indexOf'](':root')&&_0x2dee3a['push'](_0x3aa3c8['cssText']);}}return _0x115eef['length']||console['warn']('The\x20editor\x20stylesheet\x20could\x20not\x20be\x20found\x20in\x20the\x20document.\x20Check\x20your\x20webpack\x20config\x20â€“\x20style-loader\x20should\x20use\x20data-cke=true\x20attribute\x20for\x20the\x20editor\x20stylesheet.'),[..._0x2dee3a,..._0x115eef]['join']('\x20')['trim']();}function a(_0x59a638,_0x218af9={}){const _0x1b3a0d=_0x59a638['plugins']['has']('Users'),_0xd0beaa=_0x59a638['plugins']['has']('CommentsRepository'),_0x436bbb=_0x59a638['plugins']['has']('TrackChanges'),_0x35d53e=_0x218af9;if(_0x1b3a0d&&_0xd0beaa){const _0x5846ce=function(_0x13c513){const _0x3e5886={};if(!_0x13c513['length'])return _0x3e5886;for(const _0x290fc8 of _0x13c513)_0x290fc8['comments']['map'](_0x188f52=>{void 0x0===_0x3e5886[_0x290fc8['id']]&&(_0x3e5886[_0x290fc8['id']]=[]),_0x3e5886[_0x290fc8['id']]['push']({'author':_0x188f52['author']['name'],'content':_0x188f52['content'],'created':_0x188f52['createdAt'],'is_resolved':_0x290fc8['isResolved']});});return _0x3e5886;}(_0x59a638['plugins']['get']('CommentsRepository')['getCommentThreads']({'skipNotAttached':!0x0,'skipEmpty':!0x0}));Object['keys'](_0x5846ce)['length']&&(_0x35d53e['comments']=_0x5846ce);}if(_0x1b3a0d&&_0x436bbb){const _0x419e2e=_0x59a638['plugins']['get']('TrackChanges'),_0x58f0e6=_0x59a638['plugins']['get']('Users'),_0x8fc797=function(_0x7b458d,_0x3373f6){const _0x349ab0={};if(!_0x7b458d['length']||!_0x3373f6['length'])return _0x349ab0;for(const {id:_0xa3467a,createdAt:_0x4192d7,authorId:_0x4dd5ca,attributes:_0x2939aa}of _0x7b458d){const _0x32fbac=_0x2939aa&&_0x2939aa['@external'],_0x5be00d=_0x32fbac?_0x32fbac['authorName']:_0x3373f6['get'](_0x4dd5ca)['name'];_0x349ab0[_0xa3467a]={'author':_0x5be00d,'created':_0x4192d7};}return _0x349ab0;}(_0x419e2e['getSuggestions']({'toJSON':!0x0}),_0x58f0e6['users']);Object['keys'](_0x8fc797)['length']&&(_0x35d53e['suggestions']=_0x8fc797);}return(_0x35d53e['suggestions']||_0x35d53e['comments'])&&(_0x35d53e['timezone']=new Intl['DateTimeFormat']()['resolvedOptions']()['timeZone']),_0x35d53e;}function m(_0x441b86,_0x4cb0ba={}){const _0xc09634=_0x441b86['plugins']['has']('Users'),_0x795601=_0x441b86['plugins']['has']('CommentsRepository'),_0x53a835=_0x441b86['plugins']['has']('TrackChanges'),_0x1217b3=_0x441b86['plugins']['has']('MergeFields'),_0x289d56=_0x441b86['locale']['contentLanguage'],_0x2a1cdb=_0x4cb0ba,_0x34691d={};if(_0x2a1cdb['document']=_0x2a1cdb['document']||{},_0x2a1cdb['document']['language']=_0x2a1cdb['document']['language']||_0x289d56,_0xc09634&&_0x795601){const _0x49f458=function(_0x1af862){const _0x29c7a1=[];if(!_0x1af862['length'])return _0x29c7a1;for(const _0x4a2b39 of _0x1af862){const _0xa62cfe=_0x4a2b39['comments']['map'](_0x1bb2e8=>({'author':_0x1bb2e8['author']['name'],'content':_0x1bb2e8['content'],'created_at':_0x1bb2e8['createdAt']}));_0x29c7a1['push']({'thread_id':_0x4a2b39['id'],'is_resolved':_0x4a2b39['isResolved'],'comments':_0xa62cfe});}return _0x29c7a1;}(_0x441b86['plugins']['get']('CommentsRepository')['getCommentThreads']({'skipNotAttached':!0x0,'skipEmpty':!0x0}));_0x49f458['length']&&(_0x34691d['comment_threads']=_0x49f458);}if(_0xc09634&&_0x53a835){const _0x22f119=_0x441b86['plugins']['get']('TrackChanges'),_0x28db2f=_0x441b86['plugins']['get']('Users'),_0x5cc306=function(_0x27e1d1,_0x12d62f){if(!_0x27e1d1['length']||!_0x12d62f['length'])return[];return _0x27e1d1['map'](({id:_0x5df4af,createdAt:_0x50ebfd,authorId:_0x57696d,attributes:_0x2212fb})=>{const _0x4aa8c0=_0x2212fb&&_0x2212fb['@external'];return{'id':_0x5df4af,'author':_0x4aa8c0?_0x4aa8c0['authorName']:_0x12d62f['get'](_0x57696d)['name'],'created_at':_0x50ebfd};});}(_0x22f119['getSuggestions']({'toJSON':!0x0}),_0x28db2f['users']);_0x5cc306['length']&&(_0x34691d['suggestions']=_0x5cc306);}if(_0x1217b3){const _0x534b1d=_0x441b86['plugins']['get']('MergeFieldsEditing'),_0x3abfb4=_0x534b1d['previewMode'],{prefix:_0x16ccf4,suffix:_0x327b69}=_0x441b86['config']['get']('mergeFields');if(_0x2a1cdb['merge_fields']={'prefix':_0x16ccf4,'suffix':_0x327b69},'$labels'!==_0x3abfb4){_0x2a1cdb['merge_fields']['data']={};const _0x27bc10='$defaultValues'===_0x3abfb4?_0x534b1d['getDefaultValues']():_0x534b1d['getDataSetValues'](_0x3abfb4,!0x0);for(const _0x1b29d4 of Object['entries'](_0x27bc10)){const [_0x348598,_0x530c12]=_0x1b29d4;_0x2a1cdb['merge_fields']['data'][_0x348598]=null!==_0x530c12?_0x530c12:_0x534b1d['getLabel'](_0x348598);}}}return(_0x34691d['comment_threads']||_0x34691d['suggestions'])&&(_0x2a1cdb['timezone']=new Intl['DateTimeFormat']()['resolvedOptions']()['timeZone'],_0x2a1cdb['collaboration_features']=_0x34691d),_0x2a1cdb;}function p(_0x433041,_0x53792c){const t=_0x433041['t'];switch(_0x53792c){case'Export\x20to\x20Word':return t('Export\x20to\x20Word');case'An\x20error\x20occurred\x20while\x20generating\x20the\x20Word\x20file.':return t('An\x20error\x20occurred\x20while\x20generating\x20the\x20Word\x20file.');case'Word\x20document\x20export\x20started':return t('Word\x20document\x20export\x20started');case'Word\x20document\x20export\x20failed':return t('Word\x20document\x20export\x20failed');case'Word\x20document\x20export\x20successful':return t('Word\x20document\x20export\x20successful');case'Exporting\x20Word\x20document':return t('Exporting\x20Word\x20document');default:return _0x53792c;}}const h=['orientation','margin_top','margin_right','margin_bottom','margin_left','format','header','footer','comments','suggestions'];class e extends _0x522483{constructor(_0xe3bbfd){super(_0xe3bbfd),this['set']('isBusy',!0x1),this['affectsData']=!0x1;}['refresh'](){this['isEnabled']=!this['isBusy'],this['value']=this['isBusy']?'pending':void 0x0;}['execute'](_0xb6d646={}){const _0x53f788=this['editor'],_0x57ee9=_0xb6d646['version']||0x2,_0x6fd25b=0x1===_0x57ee9,_0x38292c=_0xb6d646['converterUrl']||(_0x6fd25b?'https://docx-converter.cke-cs.com/v1/convert':'https://docx-converter.cke-cs.com/v2/convert/html-docx'),_0x2a0705=_0xb6d646['converterOptions']||{},_0x3dad3d=_0x53f788['plugins']['get']('ExportWord'),_0x422632=_0xb6d646['token']||_0x3dad3d['_token'],_0x4cac83=!0x0===_0x2a0705['auto_pagination'],_0x1bef60=_0xb6d646['dataCallback']||(_0x56343b=>_0x56343b['data']['get']({'pagination':_0x4cac83}));return 0x2===_0x57ee9&&function(_0x4f3eea){for(const _0x5d779c of h)if(void 0x0!==_0x4f3eea[_0x5d779c])return!0x0;return!0x1;}(_0x2a0705)&&_0x49ef73('export-word-v1-api-is-deprecated'),this['isBusy']=!0x0,this['refresh'](),function(_0x151786){if(!_0x151786)return new Promise(_0x305c06=>_0x305c06(''));const _0x12d7e9=[];for(const _0xbb9406 of _0x151786)'EDITOR_STYLES'!==_0xbb9406?_0x12d7e9['push'](window['fetch'](_0xbb9406)['then'](_0x127d47=>_0x127d47['text']())):_0x12d7e9['push'](f());return Promise['all'](_0x12d7e9)['then'](_0x499a28=>_0x499a28['join']('\x20')['trim']());}(_0xb6d646['stylesheets']||['EDITOR_STYLES'])['then'](async _0x25f3d2=>{_0x53f788['ui']['ariaLiveAnnouncer']['announce'](p(_0x53f788['locale'],'Word\x20document\x20export\x20started'));const _0x1e5972=await _0x1bef60(_0x53f788),_0x56701b={'html':'<div\x20class=\x22ck-content\x22\x20dir=\x22'+_0x53f788['locale']['contentLanguageDirection']+'\x22>'+_0x1e5972+'</div>','css':_0x25f3d2,[_0x6fd25b?'options':'config']:{..._0x2a0705,..._0x6fd25b?a(_0x53f788,_0x2a0705):m(_0x53f788,_0x2a0705)}},_0xd0302={'method':'POST','headers':{'Content-Type':'application/json','Accept':'application/docx',..._0x422632?{'Authorization':_0x422632['value']}:null},'body':JSON['stringify'](_0x56701b)};return window['fetch'](_0x38292c,_0xd0302)['then'](_0x2ab15b=>{if(0xc8!==_0x2ab15b['status'])throw _0x2ab15b;return _0x2ab15b['blob']();})['then'](_0x362c36=>{_0x53f788['ui']['ariaLiveAnnouncer']['announce'](p(_0x53f788['locale'],'Word\x20document\x20export\x20successful'));const _0x4f7613='function'==typeof _0xb6d646['fileName']?_0xb6d646['fileName']():_0xb6d646['fileName'];this['_downloadFile'](_0x362c36,_0x4f7613||'document.docx');});})['catch'](_0x462c9d=>{const _0x3985d9=_0x53f788['plugins']['get']('Notification');throw _0x53f788['ui']['ariaLiveAnnouncer']['announce'](p(_0x53f788['locale'],'Word\x20document\x20export\x20failed'),{'politeness':'assertive'}),_0x3985d9['showWarning'](p(_0x53f788['locale'],'An\x20error\x20occurred\x20while\x20generating\x20the\x20Word\x20file.')),_0x462c9d;})['finally'](()=>{this['isBusy']=!0x1,this['refresh']();});}['_downloadFile'](_0x1a71bd,_0x31aba3){const _0x5bb884=document['createElement']('a');_0x5bb884['href']=window['URL']['createObjectURL'](_0x1a71bd),_0x5bb884['download']=_0x31aba3,_0x5bb884['click'](),_0x5bb884['remove']();}}class o extends _0x3ca72f{static get['pluginName'](){return'ExportWordUI';}static get['isOfficialPlugin'](){return!0x0;}static get['isPremiumPlugin'](){return!0x0;}['init'](){const _0x31aeff=this['editor'];_0x31aeff['ui']['componentFactory']['add']('exportWord',()=>{const _0x33647b=_0x31aeff['commands']['get']('exportWord'),_0x4d97f4=this['_createButton'](_0x367d58);return _0x4d97f4['set']({'tooltip':!0x0}),_0x4d97f4['bind']('isOn')['to'](_0x33647b,'isBusy'),_0x4d97f4;}),_0x31aeff['ui']['componentFactory']['add']('menuBar:exportWord',()=>this['_createButton'](_0x30fe83));}['_createButton'](_0x1f37fb){const _0xc1c93e=this['editor'],_0x19d510=_0xc1c93e['config']['get']('exportWord')||{},_0x38cb67=_0xc1c93e['commands']['get']('exportWord'),_0x51b42f=new _0x1f37fb(_0xc1c93e['locale']),_0xa8cf1a=new _0x9b1174();return _0x51b42f['children']['add'](_0xa8cf1a),_0xa8cf1a['bind']('isVisible')['to'](_0x38cb67,'isBusy'),_0x51b42f['iconView']['bind']('isVisible')['to'](_0x38cb67,'isBusy',_0x5d6047=>!_0x5d6047),_0x51b42f['set']({'icon':'<svg\x20viewBox=\x220\x200\x2020\x2020\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22><path\x20d=\x22M17.826\x2016.843a.75.75\x200\x200\x200-1.152-.96L15.5\x2017.29V12H14v5.29l-1.174-1.408a.75.75\x200\x200\x200-1.152.96l2.346\x202.816a.95.95\x200\x200\x200\x201.46\x200l2.346-2.815Z\x22/><path\x20d=\x22m14\x200\x205\x204.5v9.741a2.737\x202.737\x200\x200\x200-1.5-.617V6.5h-5v-5h-8v3H3V0h11Zm0\x202v3h3.3L14\x202Z\x22/><path\x20d=\x22M3\x2017.5h6.746c.1.22.23.429.391.623l.731.877H3v-1.5Z\x22/><path\x20d=\x22M8.5\x206a1.5\x201.5\x200\x200\x201\x201.493\x201.356L10\x207.5v7a1.5\x201.5\x200\x200\x201-1.356\x201.493L8.5\x2016h-7a1.5\x201.5\x200\x200\x201-1.493-1.356L0\x2014.5v-7a1.5\x201.5\x200\x200\x201\x201.356-1.493L1.5\x206h7ZM7.483\x208.795l-.042.088-.986\x202.534-.947-2.528-.043-.092a.601.601\x200\x200\x200-1.042.008l-.042.093-.883\x202.465-.937-2.475-.042-.089a.6.6\x200\x200\x200-1.107.42l.027.093\x201.514\x204\x20.044.092a.6.6\x200\x200\x200\x201.041-.01l.041-.092.88-2.458.925\x202.467.046.096a.6.6\x200\x200\x200\x201.032\x200l.043-.09\x201.554-4\x20.028-.093a.6.6\x200\x200\x200-1.104-.43v.001Z\x22/></svg>\x0a'}),_0x51b42f['bind']('isEnabled')['to'](_0x38cb67,'isEnabled'),_0x51b42f['bind']('label')['to'](_0x38cb67,'isBusy',_0x1132ec=>p(_0xc1c93e['locale'],_0x1132ec?'Exporting\x20Word\x20document':'Export\x20to\x20Word')),this['listenTo'](_0x51b42f,'execute',()=>{_0xc1c93e['execute']('exportWord',_0x19d510),_0xc1c93e['editing']['view']['focus']();}),_0x51b42f;}}class s extends _0x3ca72f{['_token'];static get['pluginName'](){return'ExportWord';}static get['isOfficialPlugin'](){return!0x0;}static get['isPremiumPlugin'](){return!0x0;}static get['requires'](){return['CloudServices',_0x1083aa,o];}['init'](){const _0x4444ad=this['editor'],_0x10d047=_0x4444ad['config']['get']('exportWord')||{};_0x4444ad['commands']['add']('exportWord',new e(_0x4444ad));const _0x41665f=_0x4444ad['plugins']['get']('CloudServices');!0x1===_0x10d047['tokenUrl']?this['_token']=null:_0x10d047['tokenUrl']?_0x41665f['registerTokenUrl'](_0x10d047['tokenUrl'])['then'](_0x1983f9=>{this['_token']=_0x1983f9;}):this['_token']=_0x41665f['token'];}}export{s as ExportWord};